<html>
<meta charset="utf-8">
<meta
    name="viewport"
    content="width=device-width, initial-scale=1, minimum-scale=1"
>

<head>
    <title>DSCR Calculator</title>

    <link
        rel="stylesheet"
        href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"
    >
</head>

<body>

    <div class="container">
        <div class="row">
            <div class="col-xs-12">
                <form
                    id="calxForm"
                    class="form-horizontal"
                    action=""
                >
                    <div class="form-group">
                        <label
                            for="borrowerName"
                            class="control-label col-sm-6 required"
                        >Borrower Name</label>
                        <div class="col-sm-6">
                            <input
                                id="borrowerName"
                                name="borrowerName"
                                type="text"
                                required="required"
                                class="form-control"
                                value="Ken Smith"
                            >
                        </div>
                    </div>
                    <div class="form-group">
                        <label
                            for="propertyAddress1"
                            class="control-label col-sm-6"
                        >Property Street Address</label>
                        <div class="col-sm-6">
                            <input
                                id="propertyAddress1"
                                name="propertyAddress1"
                                type="text"
                                required="required"
                                class="form-control"
                                value="123 Easy St"
                            >
                        </div>
                    </div>
                    <div class="form-group">
                        <label
                            for="propertyAddress2"
                            class="control-label col-sm-6"
                        >Property City, State, ZIP</label>
                        <div class="col-sm-6">
                            <input
                                id="propertyAddress2"
                                name="propertyAddress2"
                                type="text"
                                required="required"
                                class="form-control"
                                value="Anywhere, ST 12345"
                            >
                        </div>
                    </div>
                    <div class="form-group">
                        <label
                            for="ficoScore"
                            class="control-label col-sm-6"
                        >Borrower Middle FICO Score</label>
                        <div class="col-sm-6">
                            <input
                                id="ficoScore"
                                name="ficoScore"
                                type="number"
                                class="form-control"
                                value="800"
                                data-cell="C13"
                            >
                        </div>
                    </div>
                    <div class="form-group">
                        <label
                            for="numUnits"
                            class="control-label col-sm-6"
                        ># of Units</label>
                        <div class="col-sm-6">
                            <input
                                id="numUnits"
                                name="numUnits"
                                type="number"
                                class="form-control"
                                step="1"
                                value="1"
                                data-cell="C14"
                            >
                        </div>
                    </div>
                    <div class="form-group">
                        <label
                            for="purposeOfLoan"
                            class="control-label col-sm-6"
                        >Purpose of Loan</label>
                        <div class="col-sm-6">
                            <select
                                id="purposeOfLoan"
                                name="purposeOfLoan"
                                required="required"
                                class="select form-control"
                                data-cell="C15"
                            >
                                <option value="Purchase">Purchase</option>
                                <option
                                    value="RateAndTerm"
                                    selected
                                >Rate &amp; Term</option>
                                <option value="Cashout">Cashout</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label
                            for="valueBorrowerPrimary"
                            class="control-label col-sm-6"
                        >Value of Borrower's
                            Primary</label>
                        <div class="col-sm-6">
                            <!-- <div class="input-group">
                                <div class="input-group-addon">$</div> -->
                            <input
                                id="valueBorrowerPrimary"
                                name="valueBorrowerPrimary"
                                type="text"
                                required="required"
                                class="form-control"
                                value="2000000"
                                data-cell="E10"
                                data-format="$0,0[.]00"
                            >
                            <!-- <div class="input-group-addon">.00</div>
                            </div> -->
                        </div>
                    </div>
                    <div class="form-group">
                        <label
                            for="valueSubjectProperty"
                            class="control-label col-sm-6"
                        >Value of Subject
                            Property</label>
                        <div class="col-sm-6">
                            <!-- <div class="input-group">
                                <div class="input-group-addon">$</div> -->
                            <input
                                id="valueSubjectProperty"
                                name="valueSubjectProperty"
                                type="text"
                                required="required"
                                class="form-control"
                                value="1000000"
                                data-cell="E11"
                                data-format="$0,0[.]00"
                            >
                            <!-- <div class="input-group-addon">.00</div>
                            </div> -->
                        </div>
                    </div>
                    <div class="form-group">
                        <label
                            for="proposedLoanAmt"
                            class="control-label col-sm-6"
                        >Proposed Loan Amount</label>
                        <div class="col-sm-6">
                            <!-- <div class="input-group">
                                <div class="input-group-addon">$</div> -->
                            <input
                                id="proposedLoanAmt"
                                name="proposedLoanAmt"
                                type="text"
                                required="required"
                                class="form-control"
                                value="450000"
                                data-cell="E12"
                                data-format="$0,0[.]00"
                            >
                            <!-- <div class="input-group-addon">.00</div>
                            </div> -->
                        </div>
                    </div>
                    <div class="form-group">
                        <label
                            for="subjectPropertyEstMonthlyRent"
                            class="control-label col-sm-6"
                        >Subject Property Est.
                            Monthly Rent</label>
                        <div class="col-sm-6">
                            <!-- <div class="input-group">
                                <div class="input-group-addon">$</div> -->
                            <input
                                id="subjectPropertyEstMonthlyRent"
                                name="subjectPropertyEstMonthlyRent"
                                type="text"
                                required="required"
                                class="form-control"
                                value="5000"
                                data-cell="E13"
                                data-format="$0,0[.]00"
                            >
                            <!-- <div class="input-group-addon">.00</div>
                            </div> -->
                        </div>
                    </div>
                    <div class="form-group">
                        <label
                            for="subjectPropertyEstMonthlyInsur"
                            class="control-label col-sm-6"
                        >Subject Property Est.
                            Monthly Insurance</label>
                        <div class="col-sm-6">
                            <!-- <div class="input-group"> -->
                            <!-- <div class="input-group-addon">$</div> -->
                            <input
                                id="subjectPropertyEstMonthlyInsur"
                                name="subjectPropertyEstMonthlyInsur"
                                type="text"
                                required="required"
                                class="form-control"
                                value="250"
                                data-cell="E14"
                                data-format="$0,0[.]00"
                            >
                            <!-- <div class="input-group-addon">.00</div>
                            </div> -->
                        </div>
                    </div>
                    <div class="form-group">
                        <label
                            for="subjectPropertyEstMonthlyPropTaxes"
                            class="control-label col-sm-6"
                        >Subject Property
                            Est. Monthly Property Taxes</label>
                        <div class="col-sm-6">
                            <!-- <div class="input-group"> -->
                            <!-- <div class="input-group-addon">$</div> -->
                            <input
                                id="subjectPropertyEstMonthlyPropTaxes"
                                name="subjectPropertyEstMonthlyPropTaxes"
                                type="text"
                                required="required"
                                class="form-control"
                                value="1200"
                                data-cell="E15"
                                data-format="$0,0[.]00"
                            >
                            <!-- <div class="input-group-addon">.00</div> -->
                            <!-- </div> -->
                        </div>
                    </div>
                    <div class="form-group">
                        <label
                            for="optMonthlyHoaDues"
                            class="control-label col-sm-6"
                        >Monthly Homeowners Association
                            Dues (if any)</label>
                        <div class="col-sm-6">
                            <!-- <div class="input-group"> -->
                            <!-- <div class="input-group-addon">$</div> -->
                            <input
                                id="optMonthlyHoaDues"
                                name="optMonthlyHoaDues"
                                type="text"
                                class="form-control"
                                value="0"
                                data-cell="E16"
                                data-format="$0,0[.]00"
                            >
                            <!-- <div class="input-group-addon">.00</div> -->
                            <!-- </div> -->
                        </div>
                    </div>
                    <div class="form-group">
                        <label
                            for="radioInterestOnlyDesired"
                            class="control-label col-sm-6"
                        >Interest Only
                            Desired?</label>
                        <div class="col-sm-6">
                            <label class="radio-inline">
                                <input
                                    type="radio"
                                    name="radioInterestOnlyDesired"
                                    value="Yes"
                                    checked
                                    data-cell="E19"
                                > Yes </label>
                            <label class="radio-inline">
                                <input
                                    type="radio"
                                    name="radioInterestOnlyDesired"
                                    value="No"
                                    data-cell="E19"
                                > No </label>
                            <span
                                id="radioInterestOnlyDesiredHelpBlock"
                                class="help-block"
                            >Typical answer is: No</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label
                            for="radioUseNoRatioInstead"
                            class="control-label col-sm-6"
                        >Use No Ratio Instead?</label>
                        <div class="col-sm-6">
                            <label class="radio-inline">
                                <input
                                    type="radio"
                                    name="radioUseNoRatioInstead"
                                    value="Yes"
                                    checked
                                    data-cell="E20"
                                > Yes </label>
                            <label class="radio-inline">
                                <input
                                    type="radio"
                                    name="radioUseNoRatioInstead"
                                    value="No"
                                    data-cell="E20"
                                > No </label>
                            <span
                                id="radioUseNoRatioInsteadHelpBlock"
                                class="help-block"
                            >Typical answer is: No</span>
                        </div>
                    </div>
                    <div class="form-group bg-info">
                        <label
                            for="outLtvRatio"
                            class="control-label col-sm-6"
                        >Loan-to-Value (LTV) Ratio</label>
                        <div class="col-sm-6">
                            <!-- <div class="input-group"> -->
                            <input
                                id="outLtvRatio"
                                name="outLtvRatio"
                                type="text"
                                class="form-control"
                                readonly
                                disabled
                                data-cell="C16"
                                data-formula="E11/E12"
                                data-format="0.00 %"
                            >
                            <!-- <div class="input-group-addon">%</div> -->
                            <!-- </div> -->
                        </div>
                    </div>
                    <div class="form-group bg-info">
                        <label
                            for="outEstIntRate"
                            class="control-label col-sm-6"
                        >Estimated Interest Rate</label>
                        <div class="col-sm-6">
                            <!-- <div class="input-group"> -->
                            <input
                                id="outEstIntRate"
                                name="outEstIntRate"
                                type="text"
                                readonly
                                disabled
                                class="form-control"
                                data-formula="+K23"
                                data-format="0.00 %"
                            >
                            <!-- <div class="input-group-addon">%</div> -->
                            <!-- </div> -->
                        </div>
                    </div>
                    <div class="form-group bg-info">
                        <label
                            for="outPrincipalAndInterest"
                            class="control-label col-sm-6"
                        >Principal &amp;
                            Interest</label>
                        <div class="col-sm-6">
                            <!-- <div class="input-group"> -->
                            <!-- <div class="input-group-addon">$</div> -->
                            <input
                                id="outPrincipalAndInterest"
                                name="outPrincipalAndInterest"
                                type="text"
                                readonly
                                disabled
                                class="form-control"
                                data-formula="IF(K25='Error','Error',PMT(K25/12,360,E12,0,1)*-1)"
                                data-format="$0,0[.]00"
                            >
                            <!-- <div class="input-group-addon">.00</div> -->
                            <!-- </div> -->
                        </div>
                    </div>
                    <div class="form-group bg-info">
                        <label
                            for="outSubjectPiti"
                            class="control-label col-sm-6"
                        >Subject Property Combined Payment
                            (PITI)</label>
                        <div class="col-sm-6">
                            <!-- <div class="input-group"> -->
                            <!-- <div class="input-group-addon">$</div> -->
                            <input
                                id="outSubjectPiti"
                                name="outSubjectPiti"
                                type="text"
                                readonly
                                disabled
                                class="form-control"
                                data-formula="SUM(E14:E17)"
                                data-format="$0,0[.]00"
                            >
                            <!-- <div class="input-group-addon">.00</div> -->
                            <!-- </div>  -->
                        </div>
                    </div>
                    <div class="form-group bg-info">
                        <label
                            for="outDscrValue"
                            class="control-label col-sm-6"
                        >Debt Service Coverage Ratio
                            (DSCR)</label>
                        <div class="col-sm-6">
                            <input
                                id="outDscrValue"
                                name="outDscrValue"
                                type="text"
                                class="form-control"
                                readonly
                                disabled
                                data-formula="IF(K17='NA','Error',+E13/E18)"
                                data-format="0.00"
                            >
                        </div>
                    </div>

                    <!--XXX BEGIN DEBUG VALUES-->
                    <hr>
                    <div class="form-group bg-danger">
                        <label
                            for="hidABS_Score"
                            class="control-label col-sm-6"
                        >ABS_Score</label>
                        <div class="col-sm-6">
                            <input
                                id="hidABS_Score"
                                name="hidABS_Score"
                                type="text"
                                class="form-control"
                                readonly
                                disabled
                                data-cell="K14"
                            >
                        </div>
                    </div>
                    <div class="form-group bg-danger">
                        <label
                            for="hidABS_LTV"
                            class="control-label col-sm-6"
                        >ABS_LTV</label>
                        <div class="col-sm-6">
                            <input
                                id="hidABS_LTV"
                                name="hidABS_LTV"
                                type="text"
                                class="form-control"
                                readonly
                                disabled
                                data-cell="K15"
                            >
                        </div>
                    </div>
                    <div class="form-group bg-danger">
                        <label
                            for="hidBase_Rate"
                            class="control-label col-sm-6"
                        >Base_Rate</label>
                        <div class="col-sm-6">
                            <input
                                id="hidBase_Rate"
                                name="hidBase_Rate"
                                type="text"
                                class="form-control"
                                readonly
                                disabled
                                data-cell="K17"
                            >
                        </div>
                    </div>
                    <div class="form-group bg-danger">
                        <label
                            for="hidTWO_to_FOUR_Units"
                            class="control-label col-sm-6"
                        >TWO_to_FOUR_Units</label>
                        <div class="col-sm-6">
                            <input
                                id="hidTWO_to_FOUR_Units"
                                name="hidTWO_to_FOUR_Units"
                                type="text"
                                class="form-control"
                                readonly
                                disabled
                                data-cell="K19"
                            >
                        </div>
                    </div>
                    <div class="form-group bg-danger">
                        <label
                            for="hidIO"
                            class="control-label col-sm-6"
                        >IO</label>
                        <div class="col-sm-6">
                            <input
                                id="hidIO"
                                name="hidIO"
                                type="text"
                                class="form-control"
                                readonly
                                disabled
                                data-cell="K20"
                            >
                        </div>
                    </div>
                    <div class="form-group bg-danger">
                        <label
                            for="hidNo_DSCR"
                            class="control-label col-sm-6"
                        >No_DSCR</label>
                        <div class="col-sm-6">
                            <input
                                id="hidNo_DSCR"
                                name="hidNo_DSCR"
                                type="text"
                                class="form-control"
                                readonly
                                disabled
                                data-cell="K21"
                            >
                        </div>
                    </div>
                    <div class="form-group bg-danger">
                        <label
                            for="hidCashOut"
                            class="control-label col-sm-6"
                        >CashOut</label>
                        <div class="col-sm-6">
                            <input
                                id="hidCashOut"
                                name="hidCashOut"
                                type="text"
                                class="form-control"
                                readonly
                                disabled
                                data-cell="K22"
                            >
                        </div>
                    </div>
                    <div class="form-group bg-danger">
                        <label
                            for="hidNet_BPC_Rate"
                            class="control-label col-sm-6"
                        >Net_BPC_Rate</label>
                        <div class="col-sm-6">
                            <input
                                id="hidNet_BPC_Rate"
                                name="hidNet_BPC_Rate"
                                type="text"
                                class="form-control"
                                readonly
                                disabled
                                data-cell="K23"
                            >
                        </div>
                    </div>
                    <div class="form-group bg-danger">
                        <label
                            for="hidLPC_Add"
                            class="control-label col-sm-6"
                        >LPC_Add</label>
                        <div class="col-sm-6">
                            <input
                                id="hidLPC_Add"
                                name="hidLPC_Add"
                                type="text"
                                class="form-control"
                                readonly
                                disabled
                                data-cell="K24"
                            >
                        </div>
                    </div>
                    <div class="form-group bg-danger">
                        <label
                            for="hidNet_LPC_Rate"
                            class="control-label col-sm-6"
                        >Net_LPC_Rate</label>
                        <div class="col-sm-6">
                            <input
                                id="hidNet_LPC_Rate"
                                name="hidNet_LPC_Rate"
                                type="text"
                                class="form-control"
                                readonly
                                disabled
                                data-cell="K25"
                            >
                        </div>
                    </div>
                    <hr>
                    <!--XXX END DEBUG VALUES-->

                    <div class="form-group row small">
                        <div class="col-xs-12 col-sm-3 text-center">
                            <button
                                name="submit"
                                type="submit"
                                class="btn btn-block btn-info"
                            >Calculate</button>
                        </div>
                        <div class="col-xs-12 col-sm-9 small">
                            <p class="small" style="margin-top:10px;">
                                <em>The illustration shown above is for investment properties only, therefore this loan will be deemed for Business Purpose
                                Only. The rate and terms listed above are not a binding agreement by Truss Financial Group as there are other factors to
                                be considered upon application and evaluation of the subject property.</em>
                            </p>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.3/dist/jquery.validate.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.3/dist/additional-methods.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/numeral@1.4.5/numeral.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/xsanisty/calx.js@2.2.7/jquery-calx-2.2.7.min.js"></script>
    <!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script> -->
    <script>
        $(function () {
            var _ERR_MSG_PERCENT = 'Please enter a valid percentage (up to two decimal places)';
            var _ERR_MSG_DOLLAR = 'Please enter a valid dollar amount';
            var _OPTS_PERCENT = {
                required: true,
                range: [0, 100],
                // pattern: _REGEX_PERCENT,
                step: 0.01,
            };
            var _OPTS_DOLLAR_AMT = {
                required: true,
                currency: ['$', false], // dollar sign optional
                // number: true,
                // step: 0.01,
                // min: 0,
            };
            var _OPTS_DOLLAR_AMT_OPTIONAL = {
                required: false,
                currency: ['$', false], // dollar sign optional
                // number: true,
                // step: 0.01,
                // min: 0,
            };

            // override jquery validate plugin defaults
            $.validator.setDefaults({
                errorElement: "span",
                errorClass: "help-block",
                highlight: function (element, errorClass, validClass) {
                    // Only validation controls
                    if (!$(element).hasClass('novalidation')) {
                        // $(element).closest('.form-group').removeClass('has-success').addClass('has-error');
                        $(element).parent().removeClass('has-success').addClass('has-error');
                    }
                },
                unhighlight: function (element, errorClass, validClass) {
                    // Only validation controls
                    if (!$(element).hasClass('novalidation')) {
                        // $(element).closest('.form-group').removeClass('has-error').addClass('has-success');
                        $(element).parent().removeClass('has-error').addClass('has-success');
                    }
                },
                errorPlacement: function (error, element) {
                    if (element.parent('.input-group').length) {
                        error.insertAfter(element.parent());
                    } else if (element.prop('type') === 'radio' && element.parent('.radio-inline').length) {
                        error.insertAfter(element.parent().parent());
                    } else if (element.prop('type') === 'checkbox' || element.prop('type') === 'radio') {
                        error.appendTo(element.parent().parent());
                    } else {
                        error.insertAfter(element);
                    }
                }
            }); //END: `$.validator.setDefaults(...)`

            $('form#calxForm').bind('keypress', function (event) {
                if (event.keyCode === 13) {
                    return false;
                }
            });

            // Initialize form validation on the registration form.
            // It has the name attribute "registration"
            $('form#calxForm').validate({
                // Specify validation rules
                rules: {
                    // The key name on the left side is the name attribute
                    // of an input field. Validation rules are defined
                    // on the right side
                    borrowerName: {
                        required: true,
                    },
                    propertyAddress1: {
                        required: true,
                    },
                    propertyAddress2: {
                        required: true,
                    },
                    ficoScore: {
                        required: true,
                        digits: true,
                        min: 640,
                        max: 850,
                    },
                    numUnits: {
                        required: true,
                        digits: true,
                        range: [1, 99999],
                    },
                    purposeOfLoan: {
                        required: true,
                    },
                    valueBorrowerPrimary: _OPTS_DOLLAR_AMT,
                    valueSubjectProperty: _OPTS_DOLLAR_AMT,
                    proposedLoanAmt: _OPTS_DOLLAR_AMT,
                    subjectPropertyEstMonthlyRent: _OPTS_DOLLAR_AMT,
                    subjectPropertyEstMonthlyInsur: _OPTS_DOLLAR_AMT,
                    subjectPropertyEstMonthlyPropTaxes: _OPTS_DOLLAR_AMT,
                    optMonthlyHoaDues: _OPTS_DOLLAR_AMT_OPTIONAL,
                    radioInterestOnlyDesired: {
                        required: true,
                    },
                    radioUseNoRatioInstead: {
                        required: true,
                    },
                    // outLtvRatio: _OPTS_PERCENT,
                    // outEstIntRate: _OPTS_PERCENT,
                    // outPrincipalAndInterest: _OPTS_DOLLAR_AMT,
                    // outSubjectPiti: _OPTS_DOLLAR_AMT,
                },
                // Specify validation error messages
                messages: {
                    XXX: {
                        XXX: _ERR_MSG_DOLLAR,
                    },
                    YYY: 'YYY',
                },
                // Make sure the form is submitted to the destination defined
                // in the "action" attribute of the form when valid
                submitHandler: function (form) {
                    //form.submit(); // XXX TODO
                }
            }); //END: `$(...).validate(...)`

            $('form#calxForm').calx({
                data: {
                    /* beautify ignore:start */
                    //BEGIN: Pricing as of 6/11/21
                    J5: '',   K5: 50,     L5: 55,     M5: 60,     N5: 65,     O5: 70,     P5: 75,     Q5: 80,
                    J6: 760,  K6: 3.999,  L6: 4.125,  M6: 4.250,  N6: 4.250,  O6: 4.375,  P6: 4.500,  Q6: 4.625,
                    J7: 740,  K7: 4.125,  L7: 4.250,  M7: 4.375,  N7: 4.375,  O7: 4.500,  P7: 4.625,  Q7: 4.750,
                    J8: 720,  K8: 4.250,  L8: 4.375,  M8: 4.500,  N8: 4.500,  O8: 4.625,  P8: 4.750,  Q8: 4.999,
                    J9: 700,  K9: 4.375,  L9: 4.500,  M9: 4.625,  N9: 4.750,  O9: 4.875,  P9: 4.999,  Q9: 5.250,
                    J10: 680, K10: 4.500, L10: 4.625, M10: 4.750, N10: 4.875, O10: 5.125, P10: 5.250, Q10: 5.625,
                    J11: 660, K11: 4.875, L11: 4.999, M11: 5.125, N11: 5.375, O11: 5.625, P11: 5.625, Q11: 6.250,
                    J12: 640, K12: 5.250, L12: 5.375, M12: 5.500, N12: 5.750, O12: 5.999, P12: 6.250, Q12: 6.875,
                    //END
                    /* beautify ignore:end */
                    K14: {//ABS_Score
                        formula: 'IF(C13<660,"NA",IF(AND(C13<680,C13>=660),660,IF(AND(C13<700,C13>=680),680,IF(AND(C13<700,C13>=680),680,IF(AND(C13<720,C13>=700),700,IF(AND(C13<740,C13>=720),720,IF(AND(C13<760,C13>=740),740,IF(C13>=760,760))))))))',
                    },
                    K15: {//ABS_LTV
                        formula: 'IF(C16<=0.5,0.5,IF(AND(C16<=0.55,C16>0.5),0.55,IF(AND(C16<=0.6,C16>0.55),0.6,IF(AND(C16<=0.65,C16>0.6),0.65,IF(AND(C16<=0.7,C16>0.65),0.7,IF(AND(C16<=0.75,C16>0.7),0.75,IF(AND(C16<=0.8,C16>0.75),0.8,IF(C16>0.75,"NA"))))))))',
                    },
                    K17: {//Base_Rate
                        formula: 'INDEX(K6:Q12,MATCH(K14,J6:J12,-1),MATCH(K15,K5:Q5,1))',
                    },
                    K19: {//TWO_to_FOUR_Units
                        formula: 'IF(C14>=2,0.25%,0)',
                    },
                    K20: {//IO
                        formula: 'IF(E19="Yes",0.25%,0)',
                    },
                    K21: {//No_DSCR
                        formula: 'IF(E20="Yes",0.25%,0)',
                    },
                    K22: {//CashOut
                        formula: 'IF(C15="Cashout",0.25%,0)',
                    },
                    K23: {//Net_BPC_Rate
                        formula: '+K17+SUM(K19:K22)',
                    },
                    K24: {//LPC_Add
                        formula: 'IF(C18>0.02,0.01,+C18/2)',
                    },
                    K25: {//Net_LPC_Rate
                        formula: '+K23+K24',
                    },
                },//END: `data`
                // onAfterCalculate: function () { /* do the process here */ }
            });
        });
    </script>

</body>